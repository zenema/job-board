from bs4 import BeautifulSoup
import requests as r
import re

html_doc = """
<div class="joblist"><div class="job rEven"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=032ytd6s&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=032ytd6ssulzur" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Luxemburg</span></div><div class="resultAgeBlock"><span class="ageOld">vor 2 M</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=032ytd6ssulzur" target="_blank" rel="noopener nofollow">Cyber Security Infrastructure Engineer (M/F)</a></h2></div><div class="snippet">Your work environment The Luxembourg Institute of Science and Technology (LIST) is a Research and Technology Organization (RTO) active in the fields of materials, environment and <span class="xhl">I.</span>. By transforming scientific knowledge into technologies, smart data and tools, LIST empowers citizens in their choices, public authorities in their decisions and businesses in their strategies</div><div class="rUrl"><span class="resultDom">Luxembourg Institute of Science and Technology (LIST)</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rOdd"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=0000ba66&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=0000ba665drz6x" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>München</span><span>, </span><span>Poing</span></div><div class="resultAgeBlock"><span class="ageOld">vor 10 T</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=0000ba665drz6x" target="_blank" rel="noopener nofollow"><span class="thl">IT</span>-Servicedesk Agent / Mitarbeiter <span class="thl">I.</span>-Servicedesk (m/w/d)</a></h2></div><div class="snippet">Als dienstleistungsorientierter Mitarbeiter im <span class="xhl">I.</span>-Servicedesk (w/m/d) in unserem Lager in Grub/Poing bist Du für unsere Mitarbeiterinnen und Mitarbeiter ein kompetenter Ansprechpartner bei allen Hard- &amp; Softwareproblemen (Level 1.5)</div><div class="rUrl"><span class="resultDom">Best Secret GmbH</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rEven"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=0000ba66&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=0000ba66ra1z8d" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Düsseldorf</span></div><div class="resultAgeBlock"><span class="ageOld">vor 7 T</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=0000ba66ra1z8d" target="_blank" rel="noopener nofollow"><span class="thl">IT</span> Linux Systemadministrator (m/w/d) - Linux System Engineer</a></h2></div><div class="snippet">Machen Sie sich bereit für ein Unternehmen im Konzernumfeld, das als absoluter Spitzenreiter der <span class="xhl">I.</span>-Branche gilt ... Aktuell genießen bereits über 1.200 Mitarbeiter die Annehmlichkeiten unseres Mandanten wie z.B. den starken Teamzusammenhalt</div><div class="rUrl"><span class="resultDom">Ratbacher GmbH</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rOdd"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=02vx0b1n&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=02vx0b1nfx1h1g" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Bonn</span><span>, </span><span>Hannover</span><span>, </span><span>München</span><span>, </span><span>Nürnberg</span></div><div class="resultAgeBlock"><span class="ageOld">vor 1 M</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=02vx0b1nfx1h1g" target="_blank" rel="noopener nofollow">IT-Architekt Managementsysteme - Schwerpunkt Informationssicherheit und Datenschutz (m/w/d)</a></h2></div><div class="snippet">monitoring und vorantreiben der gesamtarchitektur der <span class="xhl">i.</span>-managementsysteme mit fachlichem schwerpunkt im bereich informationssicherheit und datenschutz sicherstellung der vollständigen dokumentation (informationssicherheits- und datenschutzkonzepte ... </div><div class="rUrl"><span class="resultDom">BWI GmbH</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rEven"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=0000ba66&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=0000ba66u3j8cj" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Bonn</span></div><div class="resultAgeBlock"><span class="ageOld">vor 12 T</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=0000ba66u3j8cj" target="_blank" rel="noopener nofollow"><span class="thl">IT</span>-Consultant Windows Server Systeme und VMWare (m/w/d)</a></h2></div><div class="snippet">Gemeinsam. Mit Ihnen. Für unsere Geschäftsstelle in Bonn suchen wir zum nächstmöglichen Termin eine ... Sie implementieren und verwalten selbstständig Virtualisierungsumgebungen auf der Basis von VMware und Microsoft Hyper-V - Sie implementieren und verwalten selbstständig komplexe Server auf Basis der aktuellen MS Windows Server Betriebssysteme</div><div class="rUrl"><span class="resultDom">Dedalus HealthCare GmbH</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rOdd"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=0000ba66&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=0000ba66b6p51t" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Wiesbaden</span></div><div class="resultAgeBlock"><span class="ageOld">vor 15 T</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=0000ba66b6p51t" target="_blank" rel="noopener nofollow"><span class="thl">IT</span>-Consultants / <span class="thl">I.</span>-Service-Koordinatoren – IT Service Management (ITSM) (m/w/d)</a></h2></div><div class="snippet">Darüber hinaus bietet SVA Unterstützung im Betrieb der Infrastruktur durch Operational Services mit System Engineers schon ab First Level und Service „Made in Germany“ ... Als <span class="xhl">I.</span>-Consultant (m/w/d) im ITSM sind Sie Teil unserer Geschäftsstelle für den Öffentlichen Dienst</div><div class="rUrl"><span class="resultDom">SVA System Vertrieb Alexander GmbH</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rEven"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=02vx0b1n&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=02vx0b1n3ysqlo" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Baden-Württemberg</span><span>, </span><span>Berlin</span><span>, </span><span>Brandenburg</span></div><div class="resultAgeBlock"><span class="ageOld">vor 1 M</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=02vx0b1n3ysqlo" target="_blank" rel="noopener nofollow">Senior IT-Architekt Collaboration-Lösungen - Informationssicherheit (m/w/d)</a></h2></div><div class="snippet">übernahme der verantwortung für die termingerechte konzepterstellung und fortschreibung der services bis zur freigabe des kunden analyse von kundenanforderungen sowie problemstellungen im rahmen der serviceentwicklung erstellung von ... </div><div class="rUrl"><span class="resultDom">BWI GmbH</span><a class="pin2 pin2-unmarked"></a></div></div></div><div class="job rOdd"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=0000ba66&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=0000ba66f7g3xi" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Dortmund</span><span>, </span><span>Köln</span><span>, </span><span>Paderborn</span></div><div class="resultAgeBlock"><span class="ageOld">vor 23 T</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=0000ba66f7g3xi" target="_blank" rel="noopener nofollow">Softwareentwickler (m/w/d) Frontend / Backend / DevOps</a></h2></div><div class="snippet">Bei ALTEN können Sie alles weiterentwickeln – vor allem sich selbst! Wir sind weltweit einer der führenden Entwicklungsdienstleister in Schlüsselbranchen ... Dabei haben Sie die Möglichkeit Projekte aus den Branchen Automotive, Luftfahrt, <span class="xhl">I.</span>, Telekommunikation oder Energietechnik zu realisieren</div><div class="rUrl"><span class="resultDom">ALTEN GmbH</span><a class="pin2 pin2-unmarked"></a></div></div></div><div class="job rEven"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=02vx0b1n&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=02vx0b1n4phuaj" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Saarbrücken</span></div><div class="resultAgeBlock"><span class="ageOld">vor 24 T</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=02vx0b1n4phuaj" target="_blank" rel="noopener nofollow">IT-Mitarbeiter für das Team IT-Infrastruktur (w/m/d)</a></h2></div><div class="snippet">einen interessanten und sicheren arbeitsplatz ein wertschätzendes und positives arbeitsklima in einem motivierten team mit kurzen entscheidungswegen eine attraktive tarifliche vergütung nach den avr mit umfangreichen sozialleistungen (z b zusätzliche ... </div><div class="rUrl"><span class="resultDom">Caritas Trägergesellschaft Saarbrücken mbH (CTS)</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div><div class="job rOdd"><div class="logo-div logo-div-w" style="background-image: url(&quot;/dres/logo?id=02vx0b1n&amp;k=w&quot;);"><a class="logo-a" href="/dres/jc?p=02vx0b1nzsbuf6" target="_blank" rel="noopener nofollow"></a></div><div class="job-text-div"><div class="resultAge"><div class="resultLocBlock"><span>Bonn</span><span>, </span><span>Hannover</span><span>, </span><span>München</span><span>, </span><span>Nürnberg</span></div><div class="resultAgeBlock"><span class="ageOld">vor 1 M</span></div></div><div class="rTitle0"><h2 class="rTitle"><a class="resultUrl" href="/dres/jc?p=02vx0b1nzsbuf6" target="_blank" rel="noopener nofollow">Senior IT-Architekt Managementsysteme – Schwerpunkt IT-Service-Management (w/m/d)</a></h2></div><div class="snippet">weiterentwicklung und monitoring der gesamtarchitektur der managementsysteme (tools) mit schwerpunkt im bereich it-service-management anforderungsbewertung evaluierung von managementsystemen sowie erstellung servicespezifischer lösungs-designs ... </div><div class="rUrl"><span class="resultDom">BWI GmbH</span><a class="pin2 pin2-unmarked"></a></div><div class="rCmdButtons"><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-enlarge7" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Mehr</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-bubble" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Kommentar</a></div><div class="inlineBlock" style="display: none;" aria-hidden="true"><span class="gwt-InlineHTML"><span class="icon-blocked" style="font-size:10px;padding-right:2px;padding-left:9px"></span></span><a class="uonh" href="javascript:;">Verbergen</a></div></div></div></div></div>
"""

"""Helper function. Generate pure original job post link"""
def meta_job_redirect_to_full_link(meta_job_redirect_link):
    regex = r'(&cid*?.*)|(utm.*&)|(campaign*?.*&)' # removes affiliate backlinks#
    return re.sub(regex, "", r.get(meta_job_redirect_link).url)

"""Convert scraped metajob.de job-links into original job post links"""
def get_original_job_link(input):
    output = []
    base_url = "https://www.metajob.de"
    if type(input) is not list: input = [input]
    for link_tag in input:
    # print("converting meta job link") # DEBUG
        if(link_tag['href'] != "javascript:;"):
            redirect_link = base_url + link_tag['href'] # Generate redirectional link
            # print("meta job link conversion complete!") # DEBUG
            output.append(meta_job_redirect_to_full_link(redirect_link))
    return output

# Single tag example
soup = BeautifulSoup(html_doc, 'html.parser')
a_tag = soup.find('a', href=True)
# print(a_tag)
print(get_original_job_link(a_tag))

# ## List of tags example
a_tags = soup.findAll('a', href=True)
# print(a_tags)
print(get_original_job_link(a_tags))